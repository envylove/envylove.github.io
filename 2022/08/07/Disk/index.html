<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.ico"><link rel="icon" href="/img/favicon.ico"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="author" content="yuankun"><meta name="keywords" content="hexo,theme,fluid,linux,ops,运维,分享"><meta name="description" content="磁盘是计算机主要的存储介质，可以存储大量的二进制数据，并且断电后也能保持数据不丢失，使用磁盘存储数据的时候我们可以将磁盘划分成我们所需要的格式来进行使用。"><meta property="og:type" content="article"><meta property="og:title" content="磁盘存储和文件系统管理"><meta property="og:url" content="https://itshare.work/2022/08/07/Disk/index.html"><meta property="og:site_name" content="Cookie Blog"><meta property="og:description" content="磁盘是计算机主要的存储介质，可以存储大量的二进制数据，并且断电后也能保持数据不丢失，使用磁盘存储数据的时候我们可以将磁盘划分成我们所需要的格式来进行使用。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://itshare.work/image.assets/1659865748687.png"><meta property="article:published_time" content="2022-08-07T00:40:59.000Z"><meta property="article:modified_time" content="2023-03-03T10:15:39.934Z"><meta property="article:author" content="yuankun"><meta property="article:tag" content="Linux从入门到放弃"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://itshare.work/image.assets/1659865748687.png"><title>磁盘存储和文件系统管理 - Cookie Blog</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><link rel="stylesheet" href="/css/tbdzj.css"><script id="fluid-configs">var Fluid=window.Fluid||{};Fluid.ctx=Object.assign({},Fluid.ctx);var CONFIG={hostname:"itshare.work",root:"/",version:"1.9.3",typing:{enable:!1,typeSpeed:70,cursorChar:" ",loop:!0,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"left",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"text"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,follow_dnt:!0,baidu:null,google:null,gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:"hQDROocUhxVs3CipuQjO33sY-gzGzoHsz",app_key:"CHcmi9bz6KRRaChFJVSY14g1",server_url:"https://hqdroocu.lc-cn-n1-shared.com",path:"window.location.pathname",ignore_local:!0}},search_path:"/local-search.xml"};if(CONFIG.web_analytics.follow_dnt){var dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack;Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on"))}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><meta name="generator" content="Hexo 6.3.0"></head><body><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>Cookie</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> 首页</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="iconfont icon-books"></i> 文章</a><div class="dropdown-menu" aria-labelledby="navbarDropdown"><a class="dropdown-item" href="/archives/"><i class="iconfont icon-archive-fill"></i> 归档 </a><a class="dropdown-item" href="/categories/"><i class="iconfont icon-category-fill"></i> 分类 </a><a class="dropdown-item" href="/tags/"><i class="iconfont icon-tags-fill"></i> 标签</a></div></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> 关于</a></li><li class="nav-item"><a class="nav-link" href="/links/"><i class="iconfont icon-link-fill"></i> 友链</a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(/img/default.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle">磁盘存储和文件系统管理</span></div><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2022-08-07 08:40" pubdate>2022年8月7日 早上</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 12k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 100 分钟 </span><span id="leancloud-page-views-container" class="post-meta" style="display:none"><i class="iconfont icon-eye" aria-hidden="true"></i> <span id="leancloud-page-views"></span> 次</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 style="display:none">磁盘存储和文件系统管理</h1><div class="markdown-body"><h1 id="磁盘管理与文件系统"><a href="#磁盘管理与文件系统" class="headerlink" title="磁盘管理与文件系统"></a>磁盘管理与文件系统</h1><p><strong>前言</strong><br>磁盘是计算机主要的存储介质，可以存储大量的二进制数据，并且断电后也能保持数据不丢失，使用磁盘存储数据的时候我们可以将磁盘划分成我们所需要的格式来进行使用</p><h1 id="1-磁盘结构"><a href="#1-磁盘结构" class="headerlink" title="1. 磁盘结构"></a>1. 磁盘结构</h1><p><strong>1、硬盘的物理结构</strong><br>盘片：硬盘有多个盘片，每个盘片有2面<br>磁头：每面有一个磁头</p><p><strong>2.硬盘数据结构</strong><br>扇区：磁盘上的每个磁道被等分为若干个弧段，这些弧段便是硬盘的扇区。硬盘的第一个扇区，叫做引导扇区 ，盘片被分为多个扇形区域，每个扇区存放512字节的数据，是硬盘最小的存储单元<br>磁道：当磁盘旋转时，磁头若保持在一个位置上，则每个磁头都会在磁盘表面划出一个圆形轨迹，这些圆形轨迹就叫做磁道<br>柱面：在有多个盘片构成的盘组中，由不同盘片的面，但处于同一半径圆的多个磁道组成的一个圆柱面</p><p><strong>3、磁盘结构</strong><br>硬盘存储容量 &#x3D; 磁头数 x 磁道（柱面）数 x 每道扇区数 x 每扇区字节数（512字节）<br>可以用柱面&#x2F;磁头&#x2F;扇区来唯一定位磁盘上的每一个区域<br>磁盘的接口类型：IDE、SATA、SCSI、SAS、光纤通道<br>用 fdisk -l 查看分区信息</p><h1 id="2-管理存储"><a href="#2-管理存储" class="headerlink" title="2. 管理存储"></a>2. 管理存储</h1><h2 id="2-1-磁盘分区"><a href="#2-1-磁盘分区" class="headerlink" title="2.1 磁盘分区"></a>2.1 磁盘分区</h2><h3 id="2-1-1-为什么分区"><a href="#2-1-1-为什么分区" class="headerlink" title="2.1.1 为什么分区"></a>2.1.1 为什么分区</h3><ul><li>优化I&#x2F;O性能</li><li>实现磁盘空间配额限制</li><li>提高修复速度</li><li>隔离系统和程序</li><li>安装多个OS</li><li>采用不同文件系统</li></ul><h3 id="2-1-2-分区方式"><a href="#2-1-2-分区方式" class="headerlink" title="2.1.2 分区方式"></a>2.1.2 分区方式</h3><p>两种分区方式：MBR，GPT</p><p><strong>MBR分区</strong></p><p>MBR：Master Boot Record，1982年，使用32位表示扇区数，分区不超过2T<br>划分分区的单位：<br>CentOS 5 之前按整柱面划分<br>CentOS 6 版本后可以按Sector划分<br>0磁道0扇区：512bytes<br>446bytes: boot loader 启动相关<br>64bytes：分区表，其中每16bytes标识一个分区<br>2bytes: 55AA，标识位<br>MBR分区中一块硬盘最多有4个主分区，也可以3主分区+1扩展(N个逻辑分区)<br>MBR分区：主和扩展分区对应的1–4，&#x2F;dev&#x2F;sda3，逻辑分区从5开始，&#x2F;dev&#x2F;sda5</p><p>问题：利用分区策略相同的另一台主机的分区表来还原和恢复当前主机破环的分区表？</p><p><strong>GPT分区</strong><br>GPT：GUID（Globals Unique Identifiers） partition table 支持128个分区，使用64位，支持8Z（<br>512Byte&#x2F;block ）64Z （ 4096Byte&#x2F;block）<br>使用128位UUID(Universally Unique Identifier) 表示磁盘和分区 GPT分区表自动备份在头和尾两份，<br>并有CRC校验位<br>UEFI (Unified Extensible Firmware Interface 统一可扩展固件接口)硬件支持GPT，使得操作系统可以<br>启动</p><p><strong>GPT分区结构分为4个区域：</strong></p><ul><li>GPT头</li><li>分区表</li><li>GPT分区</li><li>备份区域</li></ul><h2 id="2-2-管理分区"><a href="#2-2-管理分区" class="headerlink" title="2.2 管理分区"></a>2.2 管理分区</h2><p><strong>列出块设备</strong></p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">lsblk</span><br></code></pre></td></tr></table></figure><p><strong>创建分区命令</strong></p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">fdisk</span> 管理MBR分区<br>gdisk 管理GPT分区<br>parted 高级分区操作，可以是交互或非交互方式<br></code></pre></td></tr></table></figure><p><strong>重新设置内存中的内核分区表版本，适合于除了CentOS 6 以外的其它版本 5，7，8</strong></p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">partprobe</span><br></code></pre></td></tr></table></figure><h3 id="2-2-1-添加并检测新硬盘"><a href="#2-2-1-添加并检测新硬盘" class="headerlink" title="2.2.1 添加并检测新硬盘"></a>2.2.1 添加并检测新硬盘</h3><p>1、添加新硬盘使用lsblk命令显示出块设备</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs tap">root@ubuntu200404:~<span class="hljs-comment"># lsblk</span><br>NAME                      MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT<br>loop0                       7:0   <span class="hljs-number"> 0 </span>61.9M <span class="hljs-number"> 1 </span>loop /snap/core20/1328<br>loop1                       7:1   <span class="hljs-number"> 0 </span>67.2M <span class="hljs-number"> 1 </span>loop /snap/lxd/21835<br>loop2                       7:2   <span class="hljs-number"> 0 </span>  62M <span class="hljs-number"> 1 </span>loop /snap/core20/1587<br>loop3                       7:3   <span class="hljs-number"> 0 </span>43.6M <span class="hljs-number"> 1 </span>loop /snap/snapd/14978<br>loop4                       7:4   <span class="hljs-number"> 0 </span>  47M <span class="hljs-number"> 1 </span>loop /snap/snapd/16292<br>loop5                       7:5   <span class="hljs-number"> 0 </span>67.8M <span class="hljs-number"> 1 </span>loop /snap/lxd/22753<br>sda                         8:0   <span class="hljs-number"> 0 </span>  20G <span class="hljs-number"> 0 </span>disk <br>├─sda1                      8:1   <span class="hljs-number"> 0 </span>   1M <span class="hljs-number"> 0 </span>part <br>├─sda2                      8:2   <span class="hljs-number"> 0 </span> 1.5G <span class="hljs-number"> 0 </span>part /boot<br>└─sda3                      8:3   <span class="hljs-number"> 0 </span>18.5G <span class="hljs-number"> 0 </span>part <br>  └─ubuntu--vg-ubuntu--lv 253:0   <span class="hljs-number"> 0 </span>  10G <span class="hljs-number"> 0 </span>lvm  /<br>sr0                        11:0   <span class="hljs-number"> 1 </span> 1.2G <span class="hljs-number"> 0 </span>rom <br></code></pre></td></tr></table></figure><p>发现并没有检测出来新添加的硬盘</p><p>2、检测新硬盘</p><p>方法1：可以重启电脑</p><p>方法2： 重新扫描存储设备的scsi总线</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gradle"># host后面的数字不是固定的，以实际为准<br>root@ubuntu200404:~# echo <span class="hljs-string">&#x27;- - -&#x27;</span> &gt; <span class="hljs-regexp">/sys/</span><span class="hljs-keyword">class</span><span class="hljs-regexp">/scsi_host/</span>host32/scan<br></code></pre></td></tr></table></figure><p>再次使用lsblk命令查看发现已经多了sda的硬盘，说明成功了</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs tap">root@ubuntu200404:~<span class="hljs-comment"># lsblk</span><br>NAME                      MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT<br>loop0                       7:0   <span class="hljs-number"> 0 </span>61.9M <span class="hljs-number"> 1 </span>loop /snap/core20/1328<br>loop1                       7:1   <span class="hljs-number"> 0 </span>67.2M <span class="hljs-number"> 1 </span>loop /snap/lxd/21835<br>loop2                       7:2   <span class="hljs-number"> 0 </span>  62M <span class="hljs-number"> 1 </span>loop /snap/core20/1587<br>loop3                       7:3   <span class="hljs-number"> 0 </span>43.6M <span class="hljs-number"> 1 </span>loop /snap/snapd/14978<br>loop4                       7:4   <span class="hljs-number"> 0 </span>  47M <span class="hljs-number"> 1 </span>loop /snap/snapd/16292<br>loop5                       7:5   <span class="hljs-number"> 0 </span>67.8M <span class="hljs-number"> 1 </span>loop /snap/lxd/22753<br>sda                         8:0   <span class="hljs-number"> 0 </span>  20G <span class="hljs-number"> 0 </span>disk <br>├─sda1                      8:1   <span class="hljs-number"> 0 </span>   1M <span class="hljs-number"> 0 </span>part <br>├─sda2                      8:2   <span class="hljs-number"> 0 </span> 1.5G <span class="hljs-number"> 0 </span>part /boot<br>└─sda3                      8:3   <span class="hljs-number"> 0 </span>18.5G <span class="hljs-number"> 0 </span>part <br>  └─ubuntu--vg-ubuntu--lv 253:0   <span class="hljs-number"> 0 </span>  10G <span class="hljs-number"> 0 </span>lvm  /<br>sdb                         8:16  <span class="hljs-number"> 0 </span>  20G <span class="hljs-number"> 0 </span>disk				<span class="hljs-comment"># 新添加的硬盘 </span><br>sr0                        11:0   <span class="hljs-number"> 1 </span> 1.2G <span class="hljs-number"> 0 </span>rom<br></code></pre></td></tr></table></figure><h3 id="2-2-2-partend命令"><a href="#2-2-2-partend命令" class="headerlink" title="2.2.2 partend命令"></a>2.2.2 partend命令</h3><p><strong>注意：parted的操作都是实时生效的，小心使用</strong></p><p>格式:</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs inform7">parted <span class="hljs-comment">[选项]</span>... <span class="hljs-comment">[设备 <span class="hljs-comment">[命令 <span class="hljs-comment">[参数]</span>...]</span>...]</span><br></code></pre></td></tr></table></figure><p>范例：</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs txt">parted /dev/sdb mklabel gpt|msdos<br>parted /dev/sdb print<br>parted /dev/sdb mkpart primary 1 200 （默认M）<br>parted /dev/sdb rm 1<br>parted -l 列出所有硬盘分区信息<br></code></pre></td></tr></table></figure><h3 id="2-2-3-分区工具fdisk和gdisk"><a href="#2-2-3-分区工具fdisk和gdisk" class="headerlink" title="2.2.3 分区工具fdisk和gdisk"></a>2.2.3 分区工具fdisk和gdisk</h3><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">fdisk -l [-u] [device.<span class="hljs-string">..</span>] 查看分区<br>fdisk [device.<span class="hljs-string">..</span>] 管理MBR分区<br>gdisk [device.<span class="hljs-string">..</span>] 类fdisk 的GPT分区工具<br><br><span class="hljs-comment"># 范例：</span><br>fdisk <span class="hljs-string">/dev/sdb</span><br></code></pre></td></tr></table></figure><p><strong>子命令：</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">p</span> 分区列表<br>t 更改分区类型<br>n 创建新分区<br>d 删除分区<br>v 校验分区<br>u 转换单位<br>w 保存并退出<br><span class="hljs-selector-tag">q</span> 不保存并退出<br></code></pre></td></tr></table></figure><p><strong>查看内核是否已经识别新的分区</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">cat <span class="hljs-regexp">/proc/</span>partitions<br></code></pre></td></tr></table></figure><p><strong>CentOS 7,8 同步分区表:</strong></p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">partprobe</span><br></code></pre></td></tr></table></figure><h2 id="2-3-文件系统"><a href="#2-3-文件系统" class="headerlink" title="2.3 文件系统"></a>2.3 文件系统</h2><h3 id="2-3-1-文件系统概念"><a href="#2-3-1-文件系统概念" class="headerlink" title="2.3.1 文件系统概念"></a>2.3.1 文件系统概念</h3><p>文件系统是操作系统用于明确存储设备或分区上的文件的方法和数据结构；即在存储设备上组织文件的<br>方法。操作系统中负责管理和存储文件信息的软件结构称为文件管理系统，简称文件系统<br>从系统角度来看，文件系统是对文件存储设备的空间进行组织和分配，负责文件存储并对存入的文件进<br>行保护和检索的系统。具体地说，它负责为用户建立文件，存入、读出、修改、转储文件，控制文件的<br>存取，安全控制，日志，压缩，加密等<br>支持的文件系统：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/lib/m</span>odules<span class="hljs-regexp">/`uname -r`/</span>kernel/fs<br></code></pre></td></tr></table></figure><p>(各种文件系统)[<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Comparison_of_file_systems]">https://en.wikipedia.org/wiki/Comparison_of_file_systems]</a></p><p><strong>帮助：</strong>man 5 fs</p><h3 id="2-3-2-文件系统类型"><a href="#2-3-2-文件系统类型" class="headerlink" title="2.3.2 文件系统类型"></a>2.3.2 文件系统类型</h3><p><strong>Linux常用文件系统</strong></p><ul><li>ext2：Extended file system 适用于那些分区容量不是太大，更新也不频繁的情况，例如 &#x2F;boot 分<br>区</li><li>ext3：是 ext2 的改进版本，其支持日志功能，能够帮助系统从非正常关机导致的异常中恢复</li><li>ext4：是 ext 文件系统的最新版。提供了很多新的特性，包括纳秒级时间戳、创建和使用巨型文件<br>(16TB)、最大1EB的文件系统，以及速度的提升</li><li>xfs：SGI，支持最大8EB的文件系统</li><li>swap</li><li>iso9660 光盘</li><li>btrfs（Oracle）</li><li>reiserfs</li></ul><p><strong>Windows 常用文件系统</strong></p><ul><li>FAT32</li><li>NTFS</li><li>exFAT</li><li>Unix：</li><li>FFS（fast）</li><li>UFS（unix）</li><li>JFS2</li></ul><p><strong>网络文件系统：</strong></p><ul><li>NFS</li><li>CIFS</li></ul><p><strong>集群文件系统：</strong></p><ul><li>GFS2</li><li>OCFS2（oracle）</li></ul><p><strong>分布式文件系统：</strong></p><ul><li>fastdfs</li><li>ceph</li><li>moosefs</li><li>mogilefs</li><li>glusterfs</li><li>Lustre</li></ul><p><strong>RAW：</strong></p><p>裸文件系统,未经处理或者未经格式化产生的文件系统<br>常用的文件系统特性：</p><p><strong>FAT32</strong></p><ul><li>最多只能支持16TB的文件系统和4GB的文件</li></ul><p><strong>NTFS</strong></p><ul><li>最多只能支持16EB的文件系统和16EB的文件</li></ul><p><strong>EXT3</strong></p><ul><li>最多只能支持32TB的文件系统和2TB的文件，实际只能容纳2TB的文件系统和16GB的文件</li><li>Ext3目前只支持32000个子目录</li><li>Ext3文件系统使用32位空间记录块数量和 inode数量</li><li>当数据写入到Ext3文件系统中时，Ext3的数据块分配器每次只能分配一个4KB的块</li></ul><p><strong>EXT4：</strong></p><ul><li>EXT4是Linux系统下的日志文件系统，是EXT3文件系统的后继版本</li><li>Ext4的文件系统容量达到1EB，而支持单个文件则达到16TB</li><li>理论上支持无限数量的子目录</li><li>Ext4文件系统使用64位空间记录块数量和 inode数量</li><li>Ext4的多块分配器支持一次调用分配多个数据块</li><li>修复速度更快</li></ul><p><strong>XFS</strong></p><ul><li>根据所记录的日志在很短的时间内迅速恢复磁盘文件内容</li><li>用优化算法，日志记录对整体文件操作影响非常小</li><li>是一个全64-bit的文件系统，最大可以支持8EB的文件系统，而支持单个文件则达到8EB</li><li>能以接近裸设备I&#x2F;O的性能存储数据</li></ul><p><strong>查前支持的文件系统：</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">cat <span class="hljs-regexp">/proc/</span>filesystems<br></code></pre></td></tr></table></figure><h3 id="2-3-3-文件系统的组成部分"><a href="#2-3-3-文件系统的组成部分" class="headerlink" title="2.3.3 文件系统的组成部分"></a>2.3.3 文件系统的组成部分</h3><p>内核中的模块：ext4, xfs, vfat<br>Linux的虚拟文件系统：VFS<br>用户空间的管理工具：mkfs.ext4, mkfs.xfs,mkfs.vfat</p><h3 id="2-3-4-文件系统选择管理"><a href="#2-3-4-文件系统选择管理" class="headerlink" title="2.3.4 文件系统选择管理"></a>2.3.4 文件系统选择管理</h3><h4 id="2-3-4-1-创建文件系统"><a href="#2-3-4-1-创建文件系统" class="headerlink" title="2.3.4.1 创建文件系统"></a>2.3.4.1 创建文件系统</h4><p><strong>创建文件管理工具</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs awk">mkfs命令：<br>(<span class="hljs-number">1</span>) mkfs.FS_TYPE <span class="hljs-regexp">/dev/</span>DEVICE<br>ext4<br>xfs<br>btrfs<br>vfat<br>(<span class="hljs-number">2</span>) mkfs -t FS_TYPE <span class="hljs-regexp">/dev/</span>DEVICE<br>-L <span class="hljs-string">&#x27;LABEL&#x27;</span> 设定卷标<br>mke2fs：ext系列文件系统专用管理工具<br></code></pre></td></tr></table></figure><p><strong>常用选项：</strong></p><figure class="highlight ldif"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs ldif"><span class="hljs-literal">-</span>t &#123;ext2|ext3|ext4|xfs&#125; 指定文件系统类型<br><span class="hljs-literal">-</span>b &#123;1024|2048|4096&#125; 指定块 block 大小<br><span class="hljs-literal">-</span>L ‘LABEL’ 设置卷标<br><span class="hljs-literal">-</span>j 相当于 -t ext3， mkfs.ext3 = mkfs -t ext3 = mke2fs -j = mke2fs -t ext3<br><span class="hljs-literal">-</span>i <span class="hljs-comment"># 为数据空间中每多少个字节创建一个inode；不应该小于block大</span><br>小<br><span class="hljs-literal">-</span>N <span class="hljs-comment"># 指定分区中创建多少个inode</span><br><span class="hljs-literal">-</span>I 一个inode记录占用的磁盘空间大小，128---4096<br><span class="hljs-literal">-</span>m <span class="hljs-comment"># 默认5%,为管理人员预留空间占总空间的百分比</span><br><span class="hljs-literal">-</span>O FEATURE[,...] 启用指定特性<br><span class="hljs-literal">-</span>O ^FEATURE <br></code></pre></td></tr></table></figure><p><strong>案例：mkfs.ext4 &#x2F;dev&#x2F;sdb1</strong></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>@ubuntu200404:~# mkfs.ext4 /dev/sdb1<br><span class="hljs-attribute">mke2fs</span> <span class="hljs-number">1</span>.<span class="hljs-number">45</span>.<span class="hljs-number">5</span> (<span class="hljs-number">07</span>-Jan-<span class="hljs-number">2020</span>)<br><span class="hljs-attribute">Creating</span> filesystem with <span class="hljs-number">2621440</span> <span class="hljs-number">4</span>k blocks and <span class="hljs-number">655360</span> inodes<br><span class="hljs-attribute">Filesystem</span> UUID: a7ef4142-<span class="hljs-number">26</span>e5-<span class="hljs-number">43</span>dd-b9d0-<span class="hljs-number">24</span>c4d09155a1<br><span class="hljs-attribute">Superblock</span> backups stored <span class="hljs-literal">on</span> blocks: <br>	<span class="hljs-attribute">32768</span>, <span class="hljs-number">98304</span>, <span class="hljs-number">163840</span>, <span class="hljs-number">229376</span>, <span class="hljs-number">294912</span>, <span class="hljs-number">819200</span>, <span class="hljs-number">884736</span>, <span class="hljs-number">1605632</span><br><br><span class="hljs-attribute">Allocating</span> group tables: done                            <br><span class="hljs-attribute">Writing</span> inode tables: done                            <br><span class="hljs-attribute">Creating</span> journal (<span class="hljs-number">16384</span> blocks): done<br><span class="hljs-attribute">Writing</span> superblocks and filesystem accounting information: done <br><br><span class="hljs-attribute">root</span>@ubuntu200404:~# <br></code></pre></td></tr></table></figure><h4 id="2-3-4-2-查看和管理分区信息"><a href="#2-3-4-2-查看和管理分区信息" class="headerlink" title="2.3.4.2 查看和管理分区信息"></a>2.3.4.2 查看和管理分区信息</h4><p>blkid 可以查看块设备属性信息<br>格式：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">blkid <span class="hljs-selector-attr">[OPTION]</span>... <span class="hljs-selector-attr">[DEVICE]</span><br></code></pre></td></tr></table></figure><p>常用选项：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css">-U UUID 根据指定的UUID来查找对应的设备<br>-L <span class="hljs-selector-tag">LABEL</span> 根据指定的<span class="hljs-selector-tag">LABEL</span>来查找对应的设备<br>e2label：管理ext系列文件系统的<span class="hljs-selector-tag">LABEL</span><br></code></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">e2label</span> DEVICE<span class="hljs-meta"> [LABEL]</span><br></code></pre></td></tr></table></figure><p><strong>范例</strong></p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs elixir">root<span class="hljs-variable">@ubuntu200404</span><span class="hljs-symbol">:~</span><span class="hljs-comment"># blkid /dev/sdb1</span><br>/dev/<span class="hljs-symbol">sdb1:</span> <span class="hljs-title class_">UUID</span>=<span class="hljs-string">&quot;a7ef4142-26e5-43dd-b9d0-24c4d09155a1&quot;</span> <span class="hljs-title class_">TYPE</span>=<span class="hljs-string">&quot;ext4&quot;</span> <span class="hljs-title class_">PARTUUID</span>=<span class="hljs-string">&quot;db60ac71-01&quot;</span><br>root<span class="hljs-variable">@ubuntu200404</span><span class="hljs-symbol">:~</span><span class="hljs-comment"># </span><br></code></pre></td></tr></table></figure><p><strong>查找分区</strong></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">findfs [<span class="hljs-keyword">options</span>] LABEL=&lt;label&gt;<br>findfs [<span class="hljs-keyword">options</span>] <span class="hljs-type">UUID</span>=&lt;<span class="hljs-type">uuid</span>&gt;<br></code></pre></td></tr></table></figure><p><strong>tune2fs：重新设定ext系列文件系统可调整参数的值</strong></p><figure class="highlight ldif"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs ldif"><span class="hljs-literal">-</span>l 查看指定文件系统超级块信息；super block<br><span class="hljs-literal">-</span>L &#x27;LABEL’ 修改卷标<br><span class="hljs-literal">-</span>m <span class="hljs-comment"># 修预留给管理员的空间百分比</span><br><span class="hljs-literal">-</span>j 将ext2升级为ext3<br><span class="hljs-literal">-</span>O 文件系统属性启用或禁用, -O ^has_journal<br><span class="hljs-literal">-</span>o 调整文件系统的默认挂载选项，-o ^acl<br><span class="hljs-literal">-</span>U UUID 修改UUID号<br></code></pre></td></tr></table></figure><p><strong>dumpe2fs：显示ext文件系统信息，将磁盘块分组管理</strong><br>-h：查看超级块信息，不显示分组信息</p><p><strong>范例：查看ext文件系统的元数据和块组信息</strong></p><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs nsis">root@ubuntu200404:~<span class="hljs-comment"># dumpe2fs /dev/sdb1</span><br>dumpe2fs <span class="hljs-number">1.45</span>.<span class="hljs-number">5</span> (<span class="hljs-number">07</span>-Jan-<span class="hljs-number">2020</span>)<br><span class="hljs-keyword">File</span><span class="hljs-params">system</span> volume <span class="hljs-keyword">name</span>:   &lt;<span class="hljs-literal">none</span>&gt;<br>Last mounted <span class="hljs-literal">on</span>:          &lt;not available&gt;<br><span class="hljs-keyword">File</span><span class="hljs-params">system</span> UUID:          a7ef4142-<span class="hljs-number">26</span>e5-<span class="hljs-number">43</span>dd-b9d0-<span class="hljs-number">24</span>c4d09155a1<br><span class="hljs-keyword">File</span><span class="hljs-params">system</span> magic number:  <span class="hljs-number">0</span>xEF53<br><span class="hljs-keyword">File</span><span class="hljs-params">system</span> revision <span class="hljs-comment">#:    1 (dynamic)</span><br><span class="hljs-keyword">File</span><span class="hljs-params">system</span> features:      has_journal ext_attr resize_inode dir_index filetype extent <span class="hljs-number">64</span>bit flex_bg sparse_super large_file huge_file dir_nlink extra_isize metadata_csum<br><span class="hljs-keyword">File</span><span class="hljs-params">system</span> flags:         signed_directory_hash <br>Default mount options:    user_xattr acl<br><span class="hljs-keyword">File</span><span class="hljs-params">system</span> state:         clean<br>Errors behavior:          Continue<br><span class="hljs-keyword">File</span><span class="hljs-params">system</span> OS type:       Linux<br>Inode count:              <span class="hljs-number">655360</span><br>Block count:              <span class="hljs-number">2621440</span><br>Reserved block count:     <span class="hljs-number">131072</span><br>Free blocks:              <span class="hljs-number">2554687</span><br>Free inodes:              <span class="hljs-number">655349</span><br>First block:              <span class="hljs-number">0</span><br>......<br>......<br>......<br></code></pre></td></tr></table></figure><p><strong>xfs_info：显示示挂载或已挂载的 xfs 文件系统信息</strong></p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">xfs_info mountpoint<span class="hljs-string">|devname</span><br></code></pre></td></tr></table></figure><p><strong>范例</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">xfs_info <span class="hljs-regexp">/dev/</span>sda1<br></code></pre></td></tr></table></figure><h4 id="2-3-4-3-文件系统检测和修复"><a href="#2-3-4-3-文件系统检测和修复" class="headerlink" title="2.3.4.3 文件系统检测和修复"></a>2.3.4.3 文件系统检测和修复</h4><p>文件系统夹故障常发生于死机或者非正常关机之后，挂载为文件系统标记为“no clean”<br><strong>注意：一定不要在挂载状态下执行下面命令修复</strong></p><p>fsck: File System Check</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">fsck.FS<span class="hljs-emphasis">_TYPE</span><br><span class="hljs-emphasis">fsck -t FS_</span>TYPE<br></code></pre></td></tr></table></figure><p><strong>注意：FS_TYPE 一定要与分区上已经文件类型相同</strong></p><p><strong>常用选项</strong></p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs diff"><span class="hljs-deletion">-a 自动修复</span><br><span class="hljs-deletion">-r 交互式修复错误</span><br></code></pre></td></tr></table></figure><p><strong>e2fsck：ext系列文件专用的检测修复工具</strong></p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs diff"><span class="hljs-deletion">-y 自动回答为yes</span><br><span class="hljs-deletion">-f 强制修复</span><br><span class="hljs-deletion">-p 自动进行安全的修复文件系统问题</span><br></code></pre></td></tr></table></figure><p><strong>用法：</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">e2fsck <span class="hljs-regexp">/dev/</span>sdb2<br></code></pre></td></tr></table></figure><p><strong>xfs_repair：xfs文件系统专用检测修复工具</strong><br><strong>常用选项：</strong></p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs diff"><span class="hljs-deletion">-f 修复文件，而设备</span><br><span class="hljs-deletion">-n 只检查</span><br><span class="hljs-deletion">-d 允许修复只读的挂载设备，在单用户下修复 / 时使用，然后立即reboot</span><br></code></pre></td></tr></table></figure><p><strong>用法：</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">xfs_repair <span class="hljs-regexp">/dev/</span>sda1 <br></code></pre></td></tr></table></figure><h2 id="2-4-挂载"><a href="#2-4-挂载" class="headerlink" title="2.4 挂载"></a>2.4 挂载</h2><p>挂载:将额外文件系统与根文件系统某现存的目录建立起关联关系，进而使得此目录做为其它文件访问入<br>口的行为<br>卸载:为解除此关联关系的过程<br>把设备关联挂载点：mount Point<br>挂载点下原有文件在挂载完成后会被临时隐藏，因此，挂载点目录一般为空<br>进程正在使用中的设备无法被卸载</p><h3 id="2-4-1-挂载文件系统-mount"><a href="#2-4-1-挂载文件系统-mount" class="headerlink" title="2.4.1 挂载文件系统 mount"></a>2.4.1 挂载文件系统 mount</h3><p><strong>格式</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">mount <span class="hljs-selector-attr">[-fnrsvw]</span> <span class="hljs-selector-attr">[-t vfstype]</span> <span class="hljs-selector-attr">[-o options]</span> device mountpoint<br></code></pre></td></tr></table></figure><p>device：指明要挂载的设备</p><ul><li>设备文件：例如:&#x2F;dev&#x2F;sda5</li><li>卷标：-L ‘LABEL’, 例如 -L ‘MYDATA’</li><li>UUID： -U ‘UUID’：例如 -U ‘0c50523c-43f1-45e7-85c0-a126711d406e’</li><li>伪文件系统名称：proc, sysfs, devtmpfs, configfs</li></ul><p>mountpoint：挂载点目录必须事先存在，建议使用空目录<br>mount 常用命令选项</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs bash">-t fstype 指定要挂载的设备上的文件系统类型,如:ext4,xfs<br>-r <span class="hljs-built_in">readonly</span>，只读挂载<br>-w <span class="hljs-built_in">read</span> and write, 读写挂载,此为默认设置,可省略<br>-n 不更新/etc/mtab，mount不可见<br>-a 自动挂载所有支持自动挂载的设备(定义在了/etc/fstab文件中，且挂载选项中有<br>auto功能)<br>-L <span class="hljs-string">&#x27;LABEL&#x27;</span> 以卷标指定挂载设备<br>-U <span class="hljs-string">&#x27;UUID&#x27;</span> 以UUID指定要挂载的设备<br>-B, --<span class="hljs-built_in">bind</span> 绑定目录到另一个目录上<br>-o options：(挂载文件系统的选项)，多个选项使用逗号分隔<br>async 异步模式,内存更改时,写入缓存区buffer,过一段时间再写到磁盘中，效率高，但不安全<br><span class="hljs-built_in">sync</span> 同步模式,内存更改时，同时写磁盘，安全，但效率低下<br>atime/noatime 包含目录和文件<br>diratime/nodiratime 目录的访问时间戳<br>auto/noauto 是否支持开机自动挂载，是否支持-a选项<br><span class="hljs-built_in">exec</span>/noexec 是否支持将文件系统上运行应用程序<br>dev/nodev 是否支持在此文件系统上使用设备文件<br>suid/nosuid 是否支持suid和sgid权限<br>remount 重新挂载<br>ro/rw 只读、读写<br>user/nouser 是否允许普通用户挂载此设备，/etc/fstab使用<br>acl/noacl 启用此文件系统上的acl功能<br>loop 使用loop设备<br>_netdev 当网络可用时才对网络资源进行挂载，如：NFS文件系统<br>defaults 相当于rw, suid, dev, <span class="hljs-built_in">exec</span>, auto, nouser, async<br></code></pre></td></tr></table></figure><p><strong>挂载规则:</strong></p><ul><li>一个挂载点同一时间只能挂载一个设备</li><li>一个挂载点同一时间挂载了多个设备，只能看到最后一个设备的数据，其它设备上的数据将被隐藏</li><li>一个设备可以同时挂载到多个挂载点</li><li>通常挂载点一般是已存在空的目录</li></ul><p><strong>范例:挂载案例</strong></p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs elixir">root<span class="hljs-variable">@ubuntu200404</span><span class="hljs-symbol">:/data</span><span class="hljs-comment"># mount /dev/sdb1 /data/mysql_mount/</span><br>root<span class="hljs-variable">@ubuntu200404</span><span class="hljs-symbol">:/data</span><span class="hljs-comment"># df</span><br></code></pre></td></tr></table></figure><p><img src="/../image.assets/1659865748687.png" srcset="/img/loading.gif" lazyload alt="1659865748687"></p><h3 id="2-4-2-卸载文件系统-umount"><a href="#2-4-2-卸载文件系统-umount" class="headerlink" title="2.4.2 卸载文件系统 umount"></a>2.4.2 卸载文件系统 umount</h3><p>卸载时：可使用设备，也可以使用挂载点</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">umount 设备名<span class="hljs-string">|挂载点</span><br></code></pre></td></tr></table></figure><h3 id="2-4-3-查看挂载情况"><a href="#2-4-3-查看挂载情况" class="headerlink" title="2.4.3 查看挂载情况"></a>2.4.3 查看挂载情况</h3><p><strong>查看挂载</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-comment">#通过查看/etc/mtab文件显示当前已挂载的所有设备</span><br>mount<br><span class="hljs-comment">#查看内核追踪到的已挂载的所有设备</span><br>cat <span class="hljs-regexp">/proc/m</span>ounts<br></code></pre></td></tr></table></figure><p><strong>查看挂载点情况</strong></p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">findmnt MOUNT_POINT<span class="hljs-string">|device</span><br></code></pre></td></tr></table></figure><p><strong>查看正在访问指定文件系统的进程</strong></p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">lsof MOUNT<span class="hljs-emphasis">_POINT</span><br><span class="hljs-emphasis">fuser -v MOUNT_</span>POINT<br></code></pre></td></tr></table></figure><p><strong>终止所有在正访问指定的文件系统的进程</strong></p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">fuser -km MOUNT_POINT</span><br></code></pre></td></tr></table></figure><h3 id="2-4-4-持久挂载"><a href="#2-4-4-持久挂载" class="headerlink" title="2.4.4 持久挂载"></a>2.4.4 持久挂载</h3><p>将挂载保存到 &#x2F;etc&#x2F;fstab 中可以下次开机时，自动启用挂载<br>&#x2F;etc&#x2F;fstab格式帮助：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">man</span> <span class="hljs-number">5</span> fstab<br></code></pre></td></tr></table></figure><p>每行定义一个要挂载的文件系统,，其中包括共 6 项</p><ul><li>要挂载的设备或伪文件系统设备文件<br>LABEL：LABEL&#x3D;””<br>UUID：UUID&#x3D;””<br>伪文件系统名称：proc, sysfs</li><li>挂载点：必须是事先存在的目录</li><li>文件系统类型：ext4，xfs，iso9660，nfs，none</li><li>挂载选项：defaults ，acl，bind</li><li>转储频率：0：不做备份 1：每天转储 2：每隔一天转储</li><li>fsck检查的文件系统的顺序：允许的数字是0 1 2<br>0：不自检 ，1：首先自检；一般只有rootfs才用 2：非rootfs使用</li></ul><p><strong>添加新的挂载项，需要执行下面命令生效</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">mount -<span class="hljs-selector-tag">a</span><br></code></pre></td></tr></table></figure><p><strong>范例：centos7, 8 &#x2F;etc&#x2F;fstab 的分区UUID错误，无法启动</strong>*</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">自动进入emergency mode,输入root 密码<br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-built_in">cat</span> /proc/mounts 可以查看到/ 以rw方式挂载</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">vim /etc/fstab</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">reboot</span><br></code></pre></td></tr></table></figure><p><strong>范例：centos 6 &#x2F;etc&#x2F;fstab 的分区UUID错误，无法启动</strong></p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs gradle">如果<span class="hljs-regexp">/etc/</span>fstab 的挂载设备出错，比如文件系统故障，并且文件系统检测项（即第<span class="hljs-number">6</span>项为非<span class="hljs-number">0</span>），将导致无<br>法启动<br>自动进入emergency mode,输入root 密码<br>#cat <span class="hljs-regexp">/proc/m</span>ounts 可以查看到/ 以ro方式挂载，无法直接修改配置文件<br>#mount -o remount,rw /<br>#vim <span class="hljs-regexp">/etc/</span>fstab<br>将故障行的最后<span class="hljs-number">1</span>项，即第<span class="hljs-number">6</span>项修改为<span class="hljs-number">0</span>，开机不检测此项挂载设备的健康性，从而忽略错误，能实现启动<br></code></pre></td></tr></table></figure><p><strong>范例：&#x2F;etc&#x2F;fstab格式</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs awk">root@ubuntu200404:<span class="hljs-regexp">/data# cat /</span>etc/fstab <br><span class="hljs-comment"># /etc/fstab: static file system information.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Use &#x27;blkid&#x27; to print the universally unique identifier for a</span><br><span class="hljs-comment"># device; this may be used with UUID= as a more robust way to name devices</span><br><span class="hljs-comment"># that works even if disks are added and removed. See fstab(5).</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># &lt;file system&gt; &lt;mount point&gt;   &lt;type&gt;  &lt;options&gt;       &lt;dump&gt;  &lt;pass&gt;</span><br><span class="hljs-comment"># / was on /dev/ubuntu-vg/ubuntu-lv during curtin installation</span><br><span class="hljs-regexp">/dev/</span>disk<span class="hljs-regexp">/by-id/</span>dm-uuid-LVM-<span class="hljs-number">3</span>aQ0WgB04ZXwNPYVAYy9ssb3Wd06E34ggUUxCcYQaVwAb0L03K40wpOxbnqqqa3f / ext4 defaults <span class="hljs-number">0</span> <span class="hljs-number">1</span><br><span class="hljs-comment"># /boot was on /dev/sda2 during curtin installation</span><br><span class="hljs-regexp">/dev/</span>disk<span class="hljs-regexp">/by-uuid/</span><span class="hljs-number">5</span>e8f9763-<span class="hljs-number">2</span>db8-<span class="hljs-number">48</span>d0-<span class="hljs-number">85</span>e2-a26d76521e2f /boot ext4 defaults <span class="hljs-number">0</span> <span class="hljs-number">1</span><br>/swap.img	none	swap	sw	<span class="hljs-number">0</span>	<span class="hljs-number">0</span><br>root@ubuntu200404:/data<span class="hljs-comment"># </span><br></code></pre></td></tr></table></figure><p><strong>范例：添加新的挂载点后修改&#x2F;etc&#x2F;fstab文件</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-comment"># /etc/fstab: static file system information.</span><br><span class="hljs-comment"># </span><br><span class="hljs-comment"># Use &#x27;blkid&#x27; to print the universally unique identifier for a</span><br><span class="hljs-comment"># device; this may be used with UUID= as a more robust way to name devices</span><br><span class="hljs-comment"># that works even if disks are added and removed. See fstab(5).</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># &lt;file system&gt; &lt;mount point&gt;   &lt;type&gt;  &lt;options&gt;       &lt;dump&gt;  &lt;pass&gt;</span><br><span class="hljs-comment"># / was on /dev/ubuntu-vg/ubuntu-lv during curtin installation</span><br><span class="hljs-regexp">/dev/</span>disk<span class="hljs-regexp">/by-id/</span>dm-uuid-LVM-<span class="hljs-number">3</span>aQ0WgB04ZXwNPYVAYy9ssb3Wd06E34ggUUxCcYQaVwAb0L03K40wpOxbnqqqa3f / ext4 defaults <span class="hljs-number">0</span> <span class="hljs-number">1</span><br><span class="hljs-comment"># /boot was on /dev/sda2 during curtin installation</span><br><span class="hljs-regexp">/dev/</span>disk<span class="hljs-regexp">/by-uuid/</span><span class="hljs-number">5</span>e8f9763-<span class="hljs-number">2</span>db8-<span class="hljs-number">48</span>d0-<span class="hljs-number">85</span>e2-a26d76521e2f /boot ext4 defaults <span class="hljs-number">0</span> <span class="hljs-number">1</span><br>/swap.img       none    swap    sw      <span class="hljs-number">0</span>       <span class="hljs-number">0</span><br><br><span class="hljs-comment"># 添加该行后、重启系统</span><br>UUID=<span class="hljs-number">0</span>e850a4a-<span class="hljs-number">028</span>d-<span class="hljs-number">48</span>b2-aa18-dd8b16090aa6  <span class="hljs-regexp">/data/my</span>sql_mount  ext4  defaults  <span class="hljs-number">0</span>  <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><h2 id="2-5-处理交换文件和分区"><a href="#2-5-处理交换文件和分区" class="headerlink" title="2.5 处理交换文件和分区"></a>2.5 处理交换文件和分区</h2><h3 id="2-5-1-swap分区"><a href="#2-5-1-swap分区" class="headerlink" title="2.5.1 swap分区"></a>2.5.1 swap分区</h3><p>swap交换分区是系统RAM的补充，swap 分区支持虚拟内存。当没有足够的 RAM 保存系统处理的数据<br>时会将数据写入 swap 分区，当系统缺乏 swap 空间时，内核会因 RAM 内存耗尽而终止进程。配置过<br>多 swap 空间会造成存储设备处于分配状态但闲置，造成浪费，过多 swap 空间还会掩盖内存泄露<br>注意：为优化性能，可以将swap 分布存放，或高性能磁盘存放</p><h3 id="2-5-2-交换分区实现过程"><a href="#2-5-2-交换分区实现过程" class="headerlink" title="2.5.2 交换分区实现过程"></a>2.5.2 交换分区实现过程</h3><ol><li>创建交换分区或者文件</li><li>使用mkswap写入特殊签名</li><li>在&#x2F;etc&#x2F;fstab文件中添加适当的条目</li><li>使用swapon -a 激活交换空间</li></ol><p><strong>启用swap分区</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">swapon <span class="hljs-selector-attr">[OPTION]</span>... <span class="hljs-selector-attr">[DEVICE]</span><br></code></pre></td></tr></table></figure><p><strong>常用选项</strong></p><figure class="highlight ldif"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ldif"><span class="hljs-literal">-</span>a <span class="hljs-comment">#激活所有的交换分区</span><br><span class="hljs-literal">-</span>p PRIORITY <span class="hljs-comment">#指定优先级(-1到32767之间)，值越大,优先级越高.也可在/etc/fstab文件中的第4列指</span><br>定：pri=value<br></code></pre></td></tr></table></figure><p><strong>范例:创建swap分区</strong></p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit">[root<span class="hljs-symbol">@centos8</span> ~]<span class="hljs-meta">#mkswap /dev/sdc1</span><br></code></pre></td></tr></table></figure><p><strong>禁用swap分区</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">swapoff <span class="hljs-selector-attr">[OPTION]</span>... <span class="hljs-selector-attr">[DEVICE]</span><br></code></pre></td></tr></table></figure><p><strong>范例:禁用swap分区</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-attr">[root@centos8 ~]</span><span class="hljs-selector-id">#sed</span> -<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.bak</span> <span class="hljs-string">&#x27;/swap/d&#x27;</span> /etc/fstab<br><span class="hljs-selector-attr">[root@centos8 ~]</span><span class="hljs-selector-id">#swapoff</span> -a<br></code></pre></td></tr></table></figure><h3 id="2-5-3-swap的使用策略"><a href="#2-5-3-swap的使用策略" class="headerlink" title="2.5.3 swap的使用策略"></a>2.5.3 swap的使用策略</h3><p>&#x2F;proc&#x2F;sys&#x2F;vm&#x2F;swappiness 的值决定了当内存占用达到一定的百分比时，会启用swap分区的空间<br>使用规则</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs avrasm">当内存使用率达到<span class="hljs-number">100</span>-swappiness时,会启用交换分区<br>简单地说这个参数定义了系统对<span class="hljs-keyword">swap</span>的使用倾向，此值越大表示越倾向于使用<span class="hljs-keyword">swap</span>。<br>可以设为<span class="hljs-number">0</span>，这样做并不会禁止对<span class="hljs-keyword">swap</span>的使用，只是最大限度地降低了使用<span class="hljs-keyword">swap</span>的可能性<br></code></pre></td></tr></table></figure><p><strong>范例</strong></p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gradle">#说明：CentOS7和<span class="hljs-number">8</span>默认值为<span class="hljs-number">30</span>，内存在使用到<span class="hljs-number">100</span>-<span class="hljs-number">30</span>=<span class="hljs-number">70</span>%的时候，就开始出现有交换分区的使用。<br>[root@centos8 ~]# cat <span class="hljs-regexp">/proc/</span>sys<span class="hljs-regexp">/vm/</span>swappiness<br></code></pre></td></tr></table></figure><h2 id="2-6-磁盘常见工具"><a href="#2-6-磁盘常见工具" class="headerlink" title="2.6 磁盘常见工具"></a>2.6 磁盘常见工具</h2><h3 id="2-6-1-df"><a href="#2-6-1-df" class="headerlink" title="2.6.1 df"></a>2.6.1 df</h3><p>文件系统空间实际真正占用等信息的查看工具 df</p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs prolog">df [<span class="hljs-symbol">OPTION</span>]... [<span class="hljs-symbol">FILE</span>]...<br></code></pre></td></tr></table></figure><p><strong>常用选项</strong></p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs diff"><span class="hljs-deletion">-H 以10为单位</span><br><span class="hljs-deletion">-T 文件系统类型</span><br><span class="hljs-deletion">-h human-readable</span><br><span class="hljs-deletion">-i inodes instead of blocks</span><br><span class="hljs-deletion">-P 以Posix兼容的格式输出</span><br></code></pre></td></tr></table></figure><h3 id="2-6-3-du"><a href="#2-6-3-du" class="headerlink" title="2.6.3 du"></a>2.6.3 du</h3><p>查看某目录总体空间实际占用状态 du</p><p>显示指定目录下面各个子目录的大小,单位为KB</p><p><strong>常用选项</strong></p><figure class="highlight ldif"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ldif"><span class="hljs-literal">-</span>a --all 显示所有文件和目录的大小,默认只显示目录大小<br><span class="hljs-literal">-</span>h human-readable<br><span class="hljs-literal">-</span>s summary<br><span class="hljs-literal">-</span>-max-depth=<span class="hljs-comment"># 指定最大目录层级</span><br><span class="hljs-literal">-</span>x, --one-file-system <span class="hljs-comment">#忽略不在同一个文件系统的目录</span><br></code></pre></td></tr></table></figure><p><strong>面试题</strong></p><p>1.df 和 du 区别?什么时候df &gt;du（空分区的时候)<br>df 查看是文件系统的空间使用，包括元数据和数据，删除文件后，如果此文件正在使用，不会立即释放空间;du 查看是文件数据空间使用，不包括元数据，删除文件后空间立即释放。</p><p>2.什么时候df &lt; du?<br>目录内挂载有其它分区时的情况</p><p>3.当删除文件但不释放空间时,有什么不同?<br>du 查看文件空间释放,df不释放</p><h1 id="3-RAID"><a href="#3-RAID" class="headerlink" title="3. RAID"></a>3. RAID</h1></div><hr><div><div class="post-metas my-3"><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/Linux%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E6%94%BE%E5%BC%83/">#Linux从入门到放弃</a></div></div><div class="license-box my-3"><div class="license-title"><div>磁盘存储和文件系统管理</div><div>https://itshare.work/2022/08/07/Disk/</div></div><div class="license-meta"><div class="license-meta-item"><div>作者</div><div>yuankun</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2022年8月7日</div></div><div class="license-meta-item license-meta-date"><div>更新于</div><div>2023年3月3日</div></div><div class="license-meta-item"><div>许可协议</div><div><a target="_blank" href="https://creativecommons.org/licenses/by/4.0/"><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-by"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/2022/08/08/homework/" title="Sre云计算作业"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">Sre云计算作业</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/2022/08/03/shell%E7%BC%96%E7%A8%8B/" title="shell编程"><span class="hidden-mobile">shell编程</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article id="comments" lazyload><div id="valine"></div><script type="text/javascript">Fluid.utils.loadComments("#valine",(function(){Fluid.utils.createScript("https://lib.baomitu.com/valine/1.5.1/Valine.min.js",(function(){var i=Object.assign({appId:"hQDROocUhxVs3CipuQjO33sY-gzGzoHsz",appKey:"CHcmi9bz6KRRaChFJVSY14g1",path:"window.location.pathname",placeholder:"请在这里书写你想说的话······",avatar:"retro",meta:["nick","mail","link"],requiredFields:[],pageSize:10,lang:"zh-CN",highlight:!1,recordIP:!1,serverURLs:"",emojiCDN:null,emojiMaps:null,enableQQ:!1},{el:"#valine",path:window.location.pathname});new Valine(i),Fluid.utils.waitElementVisible("#valine .vcontent",()=>{var i="#valine .vcontent img:not(.vemoji)";Fluid.plugins.imageCaption(i),Fluid.plugins.fancyBox(i)})}))}))</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="footer-content"><span>由<a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a>强力驱动</span> <i class="iconfont icon-love"></i> <span>主题</span> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> <i class="iconfont icon-love"></i> <span>©2022 - 2023</span></div><div class="statistics"><span id="leancloud-site-pv-container" style="display:none">总访问量 <span id="leancloud-site-pv"></span> 次 </span><span id="leancloud-site-uv-container" style="display:none">总访问客数 <span id="leancloud-site-uv"></span> 人</span></div><div class="beian"><span><a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">黔ICP备2022006994号-2 </a></span><span><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=http://beian.miit.gov.cn/" rel="nofollow noopener" class="beian-police" target="_blank"><span style="visibility:hidden;width:0">|</span> <img src="/img/police_beian.png" srcset="/img/loading.gif" lazyload alt="police-icon"> <span>黔公网安备2022006994号</span></a></span></div></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js",(function(){var t=jQuery("#toc");if(0!==t.length&&window.tocbot){var i=jQuery("#board-ctn").offset().top;window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-i},CONFIG.toc)),t.find(".toc-list-item").length>0&&t.css("visibility","visible"),Fluid.events.registerRefreshCallback((function(){if("tocbot"in window){tocbot.refresh();var t=jQuery("#toc");if(0===t.length||!tocbot)return;t.find(".toc-list-item").length>0&&t.css("visibility","visible")}}))}}))</script><script src="https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js",(function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(o.join(", ")),Fluid.events.registerRefreshCallback((function(){if("anchors"in window){anchors.removeAll();var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(anchors.options.class="anchorjs-link-left"),anchors.add(o.join(", "))}}))}))</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",(function(){Fluid.plugins.fancyBox()}))</script><script>Fluid.plugins.imageCaption()</script><script defer src="/js/leancloud.js"></script><script src="/js/local-search.js"></script><script src="/js/caidai.js"></script><script src="/js/love.main.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript></body></html>